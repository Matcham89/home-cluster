apiVersion: v1
kind: ConfigMap
metadata:
  name: agentgateway-standalone-config
data:
  config.yaml: |
    config:
      binds:
        - port: 3000
          listeners:
            - routes:
                - name: mcp-auth-route
                  matches:
                    - path:
                        pathPrefix: /mcp
                  policies:
                    cors:
                      allowOrigins:
                        - "*"
                      allowHeaders:
                        - mcp-protocol-version
                        - authorization
                        - content-type
                    jwtAuth:
                      mode: strict
                      issuer: http://keycloak-service.keycloak.svc.cluster.local:8080/realms/mcp
                      audiences:
                        - agentgateway
                      jwks:
                        url: http://keycloak-service.keycloak.svc.cluster.local:8080/realms/mcp/protocol/openid-connect/certs
                  backends:
                    - mcp:
                        targets:
                          - name: yt-kmcp
                            static:
                              host: yt-kmcp.kagent.svc.cluster.local
                              port: 3000
                              protocol: SSE
