apiVersion: gateway.kgateway.dev/v1alpha1
kind: HTTPListenerPolicy
metadata:
  name: logging-policy
  namespace: istio-system
spec:
  targetRefs:
  - group: gateway.networking.k8s.io
    kind: Gateway
    name: istio-gateway
  accessLog:
  - openTelemetry:
      grpcService:
        backendRef:
          name: otel-collector-collector
          namespace: monitoring
          port: 4317
        logName: "http-gateway-access-logs"
      body: >-
        "%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %RESPONSE_CODE% "%REQ(:AUTHORITY)%" "%UPSTREAM_CLUSTER%"'        